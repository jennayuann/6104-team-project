---
timestamp: 'Sat Nov 22 2025 10:19:08 GMT-0500 (Eastern Standard Time)'
parent: '[[../20251122_101908.6390d300.md]]'
content_id: 7adabe044bc1100d5dcf591760913016793a04edae373d2f2b68f8a8c7317e40
---

# Commenting

Every action should have a comment including its signature, its requirements, and effects:

```typescript
  /**
   * createLabel (name: String): (label: Label)
   *
   * **requires** no Label with the given `name` already exists
   *
   * **effects** creates a new Label `l`; sets the name of `l` to `name`; returns `l` as `label`
   */
```

**concept**: MultiSourceNetwork \[Owner, Node, Source]

**purpose**:\
Allow an owner to maintain and explore a single unified network of nodes and connections that may originate from multiple independent sources.

**principle**:\
When an owner accumulates nodes and edges from different sources into their network, they can explore them as one combined graph. If any contributing source removes its nodes or edges, the owner’s unified network reflects these changes automatically.

***

## State

* **Networks**
  * `owner`: Owner
  * `root`: Node?

* **Memberships**
  * `owner`: Owner
  * `node`: Node
  * `sources`: JSON array of Source

* **Edges**
  * `owner`: Owner
  * `from`: Node
  * `to`: Node
  * `source`: Source
  * `weight?`: Number

* **AdjacencyEdges** (persistent adjacency table)
  * `owner`: Owner
  * `node`: Node
  * `neighbors`: Array of objects
    * `to`: Node
    * `source`: Source
    * `weight?`: Number

***

## Actions

### `createNetwork(owner: Owner, root?: Node): Empty`

* **requires**:
  * No `Networks` entry exists for `owner`.
* **effects**:
  * Creates a new `Networks` entry for the owner with optional `root`.

***

### `setRootNode(owner: Owner, root: Node): Empty`

* **requires**:
  * A `Networks` entry exists for `owner`.
  * A `Memberships` entry exists for `(owner, root)`.
* **effects**:
  * Sets the `root` field for the owner’s network.

***

### `addNodeToNetwork(owner: Owner, node: Node, source: Source): Empty`

* **requires**: none.
* **effects**:
  * Creates or updates a `Memberships` entry by adding `source` to the node’s `sources` set.

***

### `removeNodeFromNetwork(owner: Owner, node: Node, source?: Source): Empty`

* **requires**:
  * A `Memberships` entry exists for `(owner, node)`.
* **effects**:
  * If `source` is provided: remove it from the node’s `sources` set.
  * If `sources` becomes empty: delete the `Memberships` entry, remove all corresponding `Edges`, and remove the node from `AdjacencyEdges`.

***

### `addEdge(owner: Owner, from: Node, to: Node, source: Source, weight?: Number): Empty`

* **requires**:
  * `from != to`.
* **effects**:
  * Creates or updates an `Edges` entry for `(owner, from, to, source)` with optional `weight`.
  * Updates the `AdjacencyEdges` entry for `from` to include or update the neighbor `(to, source, weight)`.

***

### `removeEdge(owner: Owner, from: Node, to: Node, source: Source): Empty`

* **requires**:
  * An `Edges` entry exists for `(owner, from, to, source)`.
* **effects**:
  * Removes the specified edge from `Edges`.
  * Updates `AdjacencyEdges` for `from` to remove the neighbor `(to, source)`.

***

### Notes on `AdjacencyEdges`

* Acts as a fast lookup for outgoing edges of a node.
* Always kept in sync with `Edges`.
* Supports graph operations like traversal without recomputing adjacency from scratch.
